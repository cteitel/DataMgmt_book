<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Data Manipulation with R, Part 1 | Data Management and Reproducible Science</title>
<meta name="author" content="Claire S Teitelbaum">
<meta name="description" content="Much of this lesson draws from The Carpentries’ Data Analysis and Visualization in R for Ecologists workshop, which is published under a CC-BY 4.0 license.  6.1 Objectives Explore the structure...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="6 Data Manipulation with R, Part 1 | Data Management and Reproducible Science">
<meta property="og:type" content="book">
<meta property="og:description" content="Much of this lesson draws from The Carpentries’ Data Analysis and Visualization in R for Ecologists workshop, which is published under a CC-BY 4.0 license.  6.1 Objectives Explore the structure...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Data Manipulation with R, Part 1 | Data Management and Reproducible Science">
<meta name="twitter:description" content="Much of this lesson draws from The Carpentries’ Data Analysis and Visualization in R for Ecologists workshop, which is published under a CC-BY 4.0 license.  6.1 Objectives Explore the structure...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Management and Reproducible Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Course overview</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction: The What and Why of Reproducible Science</a></li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> Getting Started with R</a></li>
<li><a class="" href="importexport.html"><span class="header-section-number">4</span> Data Structures and Importing Data</a></li>
<li><a class="" href="troubleshooting.html"><span class="header-section-number">5</span> Troubleshooting in R</a></li>
<li><a class="active" href="filter-select-mutate.html"><span class="header-section-number">6</span> Data Manipulation with R, Part 1</a></li>
<li><a class="" href="nums-chrs.html"><span class="header-section-number">7</span> Numbers, Characters, and Factors in R</a></li>
<li><a class="" href="lubridate.html"><span class="header-section-number">8</span> Dates and Times in R</a></li>
<li><a class="" href="manipulation.html"><span class="header-section-number">9</span> Data Manipulation with R, Part 2</a></li>
<li><a class="" href="style.html"><span class="header-section-number">10</span> Coding Best Practices</a></li>
<li><a class="" href="ggplot.html"><span class="header-section-number">11</span> Data Visualization with ggplot2</a></li>
<li><a class="" href="data-presentation.html"><span class="header-section-number">12</span> Customizing Graphics with ggplot2</a></li>
<li><a class="" href="tables.html"><span class="header-section-number">13</span> Creating and Designing Data Tables</a></li>
<li><a class="" href="git.html"><span class="header-section-number">14</span> Version Control with Git and GitHub</a></li>
<li><a class="" href="github.html"><span class="header-section-number">15</span> Collaboration with GitHub (or friends)</a></li>
<li><a class="" href="markdown.html"><span class="header-section-number">16</span> Reproducible Reports with R Markdown and Quarto</a></li>
<li><a class="" href="qaqc.html"><span class="header-section-number">17</span> Data Cleaning in R</a></li>
<li><a class="" href="for-if.html"><span class="header-section-number">18</span> Iterating and Conditioning: for Loops and if Statements</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">19</span> Writing Your Own Functions</a></li>
<li><a class="" href="lists.html"><span class="header-section-number">20</span> Complex Data Structures in R</a></li>
<li><a class="" href="spatial.html"><span class="header-section-number">21</span> An Introduction to Spatial Data in R</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="filter-select-mutate" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Data Manipulation with R, Part 1<a class="anchor" aria-label="anchor" href="#filter-select-mutate"><i class="fas fa-link"></i></a>
</h1>
<p>Much of this lesson draws from The Carpentries’ <a href="https://datacarpentry.github.io/R-ecology-lesson/index.html">Data Analysis and Visualization in R for Ecologists</a> workshop, which is published under a <a href="https://datacarpentry.github.io/R-ecology-lesson/LICENSE.html">CC-BY 4.0</a> license.</p>
<div id="objectives-3" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives-3"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Explore the structure and content of data frames</li>
<li>Understand vector types and missing data</li>
<li>Understand how R assigns values to objects</li>
</ul>
</div>
<div id="additional-reading-3" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Additional reading<a class="anchor" aria-label="anchor" href="#additional-reading-3"><i class="fas fa-link"></i></a>
</h2>
<p>Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund. R for Data Science (2e). Chapter 3: Data transformation, sections 3.1-3.4. Available: <a href="https://r4ds.hadley.nz/data-transform.html" class="uri">https://r4ds.hadley.nz/data-transform.html</a></p>
</div>
<div id="murray-sanchez-et-al.-data" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Murray, Sanchez et al. data<a class="anchor" aria-label="anchor" href="#murray-sanchez-et-al.-data"><i class="fas fa-link"></i></a>
</h2>
<p>So far, we have used data built into R, and practiced loading data from <strong>URLs</strong> and <strong>files</strong>. In this lesson, we will go back to the data from Murray, Sanchez, et al., which is a meta-analysis of relationships between urbanization and wildlife health.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/raw/Murray-Sanchez_urban-wildlife.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 516 Columns: 42
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (14): TITLE, AUTHORS, JOURNAL, health, condition, toxtype, ptype, stress...
## dbl (28): study, YEAR, SAMPLE_SIZE, EFFECT_DIRECTION, pval, r, yi, vi, rlowe...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="filtering-rows-creating-and-selecting-columns" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Filtering rows; creating and selecting columns<a class="anchor" aria-label="anchor" href="#filtering-rows-creating-and-selecting-columns"><i class="fas fa-link"></i></a>
</h2>
<p>One of the most important skills for working with data in R is the ability to manipulate, modify, and reshape data. The <code>dplyr</code> and <code>tidyr</code> packages in the <code>tidyverse</code> provide some very useful functions for many common data manipulation tasks.</p>
<div id="selecting-columns-with-select" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> Selecting columns with <code>select()</code><a class="anchor" aria-label="anchor" href="#selecting-columns-with-select"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>select</code> function allows you to take only some some columns from your data frame. The first argument is the name of the data frame, and the following arguments are the names of the columns you want. Here, we will take only species information and record IDs from the Murray et al. dataset:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">study</span>, <span class="va">host.class</span>, <span class="va">aqterr</span>, <span class="va">host.species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">urban_species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   study host.class aqterr      host.species         
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                
## 1  1236 mammals    terrestrial Trichosurus_vulpecula
## 2  1236 mammals    terrestrial Trichosurus_vulpecula
## 3  1236 mammals    terrestrial Trichosurus_vulpecula
## 4  1236 mammals    terrestrial Trichosurus_vulpecula
## 5  1236 mammals    terrestrial Trichosurus_vulpecula
## 6  1236 mammals    terrestrial Trichosurus_vulpecula</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">urban_species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 516   4</code></pre>
<p>This function can be especially useful to clean up your data, for example when you have created intermediate columns, or when you read in a data set that has a lot of extraneous information. Notice that columns are now reordered: <code>host.species</code> was specified last within <code>select</code>, so it is now the last column.</p>
<p>We can also use <code>select</code> to remove columns, using the - symbol.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="op">-</span><span class="va">TITLE</span>, <span class="op">-</span><span class="va">AUTHORS</span>, <span class="op">-</span><span class="va">YEAR</span>, <span class="op">-</span><span class="va">JOURNAL</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 38
##    study health    condition toxtype ptype  stress2 SAMPLE_SIZE EFFECT_DIRECTION
##    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;
##  1  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Preva… &lt;NA&gt;             59                0
##  2  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Preva… &lt;NA&gt;             59               -1
##  3  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Richn… &lt;NA&gt;            278               -1
##  4  1236 condition Adjusted  &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             49                1
##  5  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Inten… &lt;NA&gt;             16               -1
##  6  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Inten… &lt;NA&gt;             10                1
##  7  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Preva… &lt;NA&gt;             59                1
##  8  1236 parasites &lt;NA&gt;      &lt;NA&gt;    Preva… &lt;NA&gt;             59               -1
##  9  1326 toxicants &lt;NA&gt;      metal   &lt;NA&gt;   &lt;NA&gt;             39               -1
## 10  1326 toxicants &lt;NA&gt;      metal   &lt;NA&gt;   &lt;NA&gt;             39               -1
## # ℹ 506 more rows
## # ℹ 30 more variables: pval &lt;dbl&gt;, r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;,
## #   rupper &lt;dbl&gt;, yir &lt;dbl&gt;, ott_id &lt;dbl&gt;, host.species &lt;chr&gt;,
## #   host.class &lt;chr&gt;, aqterr &lt;chr&gt;, parasite2 &lt;chr&gt;, close &lt;dbl&gt;,
## #   nonclose &lt;dbl&gt;, vector &lt;dbl&gt;, intermediate &lt;dbl&gt;, routes &lt;dbl&gt;,
## #   mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;, udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;,
## #   uchange_1000 &lt;dbl&gt;, uchange_10000 &lt;dbl&gt;, umean_1000 &lt;dbl&gt;, …</code></pre>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> also works with numeric vectors for the order of the columns. To select the 3rd, 4th, 5th, and 10th columns, we could run the following code:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 4
##    AUTHORS          YEAR JOURNAL                          stress2
##    &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;                            &lt;chr&gt;  
##  1 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  2 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  3 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  4 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  5 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  6 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  7 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  8 Webster et al.   2014 Wildlife Biology                 &lt;NA&gt;   
##  9 Hargitai et al.  2016 Science of the Total Environment &lt;NA&gt;   
## 10 Hargitai et al.  2016 Science of the Total Environment &lt;NA&gt;   
## # ℹ 506 more rows</code></pre>
<p>You should be careful when using this method, since you are being less explicit about which columns you want. However, it can be useful if you have a data frame with many columns and you don’t want to type out too many names.</p>
<p>We can also select columns based on their properties using the <code><a href="https://tidyselect.r-lib.org/reference/where.html">where()</a></code> function. For example, to select all character columns:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 14
##    TITLE     AUTHORS JOURNAL health condition toxtype ptype stress2 host.species
##    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;       
##  1 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;    Trichosurus…
##  2 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;    Trichosurus…
##  3 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Rich… &lt;NA&gt;    Trichosurus…
##  4 Ectopara… Webste… Wildli… condi… Adjusted  &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;    Trichosurus…
##  5 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;    Trichosurus…
##  6 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;    Trichosurus…
##  7 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;    Trichosurus…
##  8 Ectopara… Webste… Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;    Trichosurus…
##  9 Effects … Hargit… Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;    Parus_major 
## 10 Effects … Hargit… Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;    Parus_major 
## # ℹ 506 more rows
## # ℹ 5 more variables: host.class &lt;chr&gt;, aqterr &lt;chr&gt;, parasite2 &lt;chr&gt;,
## #   mroute &lt;chr&gt;, COUNTRY &lt;chr&gt;</code></pre>
</div>
<div id="subsetting-data-with-filter" class="section level3" number="6.4.2">
<h3>
<span class="header-section-number">6.4.2</span> Subsetting data with <code>filter()</code><a class="anchor" aria-label="anchor" href="#subsetting-data-with-filter"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function subsets a data frame to rows that meet some criteria. For example, to get all rows where the taxon sampled was a bird:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">host.class</span> <span class="op">==</span> <span class="st">"birds"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 159 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  2  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  3  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  4  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  5  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  6  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  7  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  8  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  9  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 149 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<p>Now we are introducing logical statements with the <code>==</code> sign! <code>==</code> means “is equal to”. It is very different from <code>=</code>, which specifies arguments in functions (and can be used as an assignment operator, but that is not recommended). A few other useful operators and functions for filtering are:</p>
<ul>
<li>
<code>!=</code>, which means “not equal to.” <code>!</code> means “not” and can be applied to many logical statements.</li>
<li>
<code>%in%</code>, which asks if the left hand side is found anywhere in the vector on the right side.</li>
<li>
<code>is.na</code>, which asks if the value is missing.</li>
<li>
<code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, and <code>&lt;=</code>, which filter based on the values of numeric columns.</li>
</ul>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">host.class</span> <span class="op">!=</span> <span class="st">"mammals"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 321 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  2  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  3  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  4  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  5  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  6  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  7  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  8  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  9  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 311 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">host.class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"birds"</span>,<span class="st">"fish"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 251 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  2  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  3  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  4  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  5  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  6  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  7  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  8  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  9  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 241 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 253 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1236 Ectoparas… Webste…  2014 Wildli… condi… Adjusted  &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   
##  2  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  3  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  4  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  5  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  6  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  7  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  8  1480 Environme… Garcia…  2005 Bullet… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  9  1869 Great Tit… Torne-…  2013 J Orni… stress &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  other  
## 10  1903 halogenat… Olsson…  1999 Scienc… condi… Raw       &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 243 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">YEAR</span> <span class="op">&gt;=</span> <span class="fl">2010</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 422 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  2  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  3  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Rich… &lt;NA&gt;   
##  4  1236 Ectoparas… Webste…  2014 Wildli… condi… Adjusted  &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   
##  5  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  6  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  7  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  8  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  9  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 412 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<p>We can also filter using multiple criteria simultaneously using <code>&amp;</code> (AND) and <code>|</code> (OR):</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">host.class</span> <span class="op">!=</span> <span class="st">"mammals"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 133 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  2  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  3  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  4  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  5  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  6  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  7  1426 Egrets as… Boncom…  2003 Archiv… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
##  8  1934 Helminth … Rzad e…  2014 Helmin… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  9  2166 Influence… Goulso…  2012 Functi… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
## 10  2166 Influence… Goulso…  2012 Functi… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
## # ℹ 123 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">ptype</span> <span class="op">==</span> <span class="st">"Prevalence"</span> <span class="op">|</span> <span class="va">SAMPLE_SIZE</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 218 × 42
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  2  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  3  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Rich… &lt;NA&gt;   
##  4  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  5  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  6  1869 Great Tit… Torne-…  2013 J Orni… stress &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;  other  
##  7  1934 Helminth … Rzad e…  2014 Helmin… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  8  1955 high freq… Bagagl…  2003 Medica… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  9  2129 infection… Robard…  2008 Parasi… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
## 10  2129 infection… Robard…  2008 Parasi… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
## # ℹ 208 more rows
## # ℹ 32 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<p>Can you describe what is being included and excluded in each of these statements?</p>
<p>Use the <code>urban_data</code> data to make a data frame with data from 2000 through 2010.</p>
</div>
<div id="making-new-columns-with-mutate" class="section level3" number="6.4.3">
<h3>
<span class="header-section-number">6.4.3</span> Making new columns with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#making-new-columns-with-mutate"><i class="fas fa-link"></i></a>
</h3>
<p>Another common task is making new columns using values in existing columns. For example, we we can create a new column that measures gross domestic product (GDP, the <code>gdpbill</code> column) length in tens of billions instead of billions of dollars:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, gdpbill10 <span class="op">=</span> <span class="va">gdpbill</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><code>mutate</code> can also create multiple columns at once, separated by a comma:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, gdpbill10 <span class="op">=</span> <span class="va">gdpbill10</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>                      years_since_1998 <span class="op">=</span> <span class="va">YEAR</span> <span class="op">-</span> <span class="fl">1998</span><span class="op">)</span> <span class="co">#not the best column name - a little long</span></span>
<span><span class="co"># To view the new columns, we will select them, </span></span>
<span><span class="co"># because this data frame has too many columns to print them all</span></span>
<span><span class="co"># and our new columns are placed at the end</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">gdpbill</span>, <span class="va">gdpbill10</span>, <span class="va">YEAR</span>, <span class="va">years_since_1998</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 4
##    gdpbill gdpbill10  YEAR years_since_1998
##      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;
##  1    926       9.26  2014               16
##  2    926       9.26  2014               16
##  3    926       9.26  2014               16
##  4    926       9.26  2014               16
##  5    926       9.26  2014               16
##  6    926       9.26  2014               16
##  7    926       9.26  2014               16
##  8    926       9.26  2014               16
##  9    130.      1.30  2016               18
## 10    130.      1.30  2016               18
## # ℹ 506 more rows</code></pre>
<p>We can also use <code>mutate</code> to modify values in existing columns. For example, we see that the transmission mode columns are coded as integers instead of logical:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">urban_data</span><span class="op">$</span><span class="va">close</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  1  0 NA</code></pre>
<p>To replace <code>1</code>s with <code>TRUE</code>s and <code>0</code>s with <code>FALSE</code>s, we can use the <code>as.logical</code> function:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_close</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, close <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">urban_data_close</span><span class="op">$</span><span class="va">close</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE    NA</code></pre>
<p>Note that this works because R assumes by default that <code>0</code> means <code>FALSE</code> and <code>1</code> means <code>TRUE.</code> We will get into <code>if</code> and <code>ifelse</code> statements later, which would allow you to convert more types of values. Another way to do the same thing would be using a logical statement:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_lgl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, nonclose <span class="op">=</span> <span class="op">(</span><span class="va">nonclose</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">urban_data_lgl</span><span class="op">$</span><span class="va">nonclose</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  TRUE    NA FALSE</code></pre>
<p>As with <code>filter</code>, we can use <code>mutate</code> to create multiple columns at once:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_lgl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, close <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span>,</span>
<span>                      nonclose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="va">nonclose</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can also apply exactly the same function to multiple columns:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_lgl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">close</span>, <span class="va">nonclose</span>, <span class="va">vector</span>, <span class="va">intermediate</span><span class="op">)</span>, <span class="va">as.logical</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that this is a little more complicated! The first argument is still the data set (<code>urban_data</code>), but the second argument is now a vector of column names, enclosed within <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, and the function <code>across</code> applies the function to multiple columns. The second argument to <code>across</code> is the function that is applied to all the columns.</p>
<p>Another common task is to replace NAs with another value, or to replace certain character strings (e.g., <code>""</code>) with <code>NA</code>s. For example, for studies with no difference in urbanization across the study area (the <code>udiff_1000</code> column), we might want to replace <code>0</code> with a missing value. Here, we can use a combination of <code>mutate</code> with the <code>na_if</code> function from <code>tidyr</code>:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, udiff_1000 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">udiff_1000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 44
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  2  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  3  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Rich… &lt;NA&gt;   
##  4  1236 Ectoparas… Webste…  2014 Wildli… condi… Adjusted  &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   
##  5  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  6  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  7  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  8  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  9  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 506 more rows
## # ℹ 34 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<p>Finally, a very useful function for creating new columns is <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> (or the base R version, <code>ifelse</code>). This is a simplified version of the <code>if</code> statements that we will learn about later in the class. Again makes a vector as a function of another vector, this time conditionally. I provide a conditional statement (“if”) and an alternative (“else”). The example above is essentially a streamlined ifelse function; the following code does the same thing:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data</span>, udiff_1000 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">udiff_1000</span> <span class="op">==</span> <span class="fl">0</span>, <span class="cn">NA</span>, <span class="va">udiff_1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 516 × 44
##    study TITLE      AUTHORS  YEAR JOURNAL health condition toxtype ptype stress2
##    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  2  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  3  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Rich… &lt;NA&gt;   
##  4  1236 Ectoparas… Webste…  2014 Wildli… condi… Adjusted  &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   
##  5  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  6  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Inte… &lt;NA&gt;   
##  7  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  8  1236 Ectoparas… Webste…  2014 Wildli… paras… &lt;NA&gt;      &lt;NA&gt;    Prev… &lt;NA&gt;   
##  9  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## 10  1326 Effects o… Hargit…  2016 Scienc… toxic… &lt;NA&gt;      metal   &lt;NA&gt;  &lt;NA&gt;   
## # ℹ 506 more rows
## # ℹ 34 more variables: SAMPLE_SIZE &lt;dbl&gt;, EFFECT_DIRECTION &lt;dbl&gt;, pval &lt;dbl&gt;,
## #   r &lt;dbl&gt;, yi &lt;dbl&gt;, vi &lt;dbl&gt;, rlower &lt;dbl&gt;, rupper &lt;dbl&gt;, yir &lt;dbl&gt;,
## #   ott_id &lt;dbl&gt;, host.species &lt;chr&gt;, host.class &lt;chr&gt;, aqterr &lt;chr&gt;,
## #   parasite2 &lt;chr&gt;, close &lt;dbl&gt;, nonclose &lt;dbl&gt;, vector &lt;dbl&gt;,
## #   intermediate &lt;dbl&gt;, routes &lt;dbl&gt;, mroute &lt;chr&gt;, mlat &lt;dbl&gt;, mlon &lt;dbl&gt;,
## #   udiff_1000 &lt;dbl&gt;, udiff_10000 &lt;dbl&gt;, uchange_1000 &lt;dbl&gt;, …</code></pre>
<p>Here, the first argument is the condition: I am asking whether <code>udiff_1000</code> is equal to zero. The second argument is the output if the condition is true: in this place I would like the function to return <code>NA</code>. The second argument is the output if the condition is false: in this case I would like it to return the original value of the vector/column, i.e., <code>udiff_1000</code>.</p>
<p>Some simpler examples:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a vector</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"elephant"</span>, <span class="st">"snow leopard"</span>, <span class="st">"indian leopard"</span>, <span class="st">"sloth bear"</span>, <span class="st">"bengal tiger"</span><span class="op">)</span></span>
<span><span class="co"># Check whether these animals are cats</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"snow leopard"</span>, <span class="st">"indian leopard"</span>, <span class="st">"bengal tiger"</span><span class="op">)</span>, <span class="st">"cat"</span> , <span class="st">"not a cat"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "not a cat" "cat"       "cat"       "not a cat" "cat"</code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a vector</span></span>
<span><span class="va">nums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">194</span>, <span class="fl">281</span>, <span class="fl">92</span><span class="op">)</span></span>
<span><span class="co"># Check if each element is even or odd</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">nums</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span>,<span class="st">"even"</span>,<span class="st">"odd"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "even" "even" "odd"  "even"</code></pre>
<p>Notice that here, <code>%%</code> returns the remainder of a division, so numbers divided by two with a remainder of zero are even.</p>
<p>The main difference between the <code>tidyverse's</code> <code>if_else</code> and base R’s <code>ifelse</code> is that <code>if_else</code> preserves factor levels and other types (for example, dates, which we will learn about soon).</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unlike `ifelse()`, `if_else()` preserves types</span></span>
<span><span class="co"># This example comes from the help page for if_else</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"i"</span>, <span class="st">"e"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"c"</span>, <span class="st">"i"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="va">x</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  1 NA NA NA NA  3 NA  2</code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="va">x</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] a    &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; c    &lt;NA&gt; b   
## Levels: a b c e f g i</code></pre>
</div>
<div id="sorting-data-tables" class="section level3" number="6.4.4">
<h3>
<span class="header-section-number">6.4.4</span> Sorting data tables<a class="anchor" aria-label="anchor" href="#sorting-data-tables"><i class="fas fa-link"></i></a>
</h3>
<p>In many cases, the order of data in table is not important; the information is the same regardless of its row number. Sorting and ordering tables can be useful for filtering them and for calculating some columns. The <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> will sort a data frame by a column:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">study</span>, <span class="va">AUTHORS</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   study AUTHORS              r
##   &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
## 1  1236 Webster et al.  0     
## 2  1236 Webster et al. -0.229 
## 3  1236 Webster et al. -0.0770
## 4  1236 Webster et al.  0.200 
## 5  1236 Webster et al. -0.301 
## 6  1236 Webster et al.  0.063</code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">r_ordered</span>, <span class="va">study</span>, <span class="va">AUTHORS</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   study AUTHORS                 r
##   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1  3913 Zapata et al.      -0.997
## 2  3913 Zapata et al.      -0.984
## 3   521 Abu El-Saad et al. -0.982
## 4   851 Bilandzic et al.   -0.979
## 5   521 Abu El-Saad et al. -0.977
## 6   521 Abu El-Saad et al. -0.975</code></pre>
<p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> can take multiple column names, in which case the data frame is sorted first by the first column. Then, if any values are duplicated in that column, the rows are sorted within that group by the second column, and so on:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">AUTHORS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">author_ordered</span>, <span class="va">study</span>, <span class="va">AUTHORS</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   study AUTHORS                 r
##   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1   521 Abu El-Saad et al. -0.922
## 2   521 Abu El-Saad et al. -0.963
## 3   521 Abu El-Saad et al. -0.378
## 4   521 Abu El-Saad et al. -0.900
## 5   521 Abu El-Saad et al. -0.974
## 6   521 Abu El-Saad et al. -0.952</code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_r_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">AUTHORS</span>, <span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">author_r_ordered</span>, <span class="va">study</span>, <span class="va">AUTHORS</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   study AUTHORS                 r
##   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1   521 Abu El-Saad et al. -0.982
## 2   521 Abu El-Saad et al. -0.977
## 3   521 Abu El-Saad et al. -0.975
## 4   521 Abu El-Saad et al. -0.974
## 5   521 Abu El-Saad et al. -0.963
## 6   521 Abu El-Saad et al. -0.952</code></pre>
<p>And the base R function <code>sort</code> will order a vector:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] a b c e f g i i
## Levels: a b c e f g i</code></pre>
</div>
</div>
<div id="pipes" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Pipes<a class="anchor" aria-label="anchor" href="#pipes"><i class="fas fa-link"></i></a>
</h2>
<p>What if you want to do a bunch of operations in order, for example filtering your data and creating new columns. The most basic way to do this is to create intermediate objects:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_mamm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">urban_data</span>, <span class="va">host.class</span> <span class="op">==</span> <span class="st">"mammals"</span><span class="op">)</span></span>
<span><span class="va">urban_data_mamm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data_mamm</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">close</span>, <span class="va">nonclose</span>, <span class="va">vector</span>, <span class="va">intermediate</span><span class="op">)</span>, <span class="va">as.logical</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You could also nest your functions, but as you can see this gets unwieldy quickly:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_mamm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">urban_data_mamm</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">close</span>, <span class="va">nonclose</span>, <span class="va">vector</span>, <span class="va">intermediate</span><span class="op">)</span>, <span class="va">as.logical</span><span class="op">)</span><span class="op">)</span>, <span class="va">host.class</span> <span class="op">==</span> <span class="st">"mammals"</span><span class="op">)</span></span></code></pre></div>
<p><code>tidyverse</code> provides a powerful way to tie a squence of actions together: the pipe (<code>%&gt;%</code>). Pipes can initially be intimidating (what are those <code>%</code> doing?!) and they are by no means necessary to use, but they can make your code neat and easier to understand.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urban_data_mamm</span> <span class="op">&lt;-</span> <span class="va">urban_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">host.class</span> <span class="op">==</span> <span class="st">"mammals"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">close</span>, <span class="va">nonclose</span>, <span class="va">vector</span>, <span class="va">intermediate</span><span class="op">)</span>, <span class="va">as.logical</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You can read the pipe as <em>then</em>: take the urban data, <em>then</em> take only rows for mammals, <em>then</em> convert the transmission mode columns to logical. The pipe takes the output of the previous line and feeds it as input into the next one. Notice that you don’t have to repeat the name of the data object,because the data is whatever the pipe is feeding into the function. There are
several advantages to using pipes compared to traditional syntax. First, by
using a pipe in the example above, we avoided saving intermediate objects (e.g.,
<code>no_pkey</code>) to the environment: we only saved the final result we wanted. Second,
we typed less. Third, our code is more readable because the syntax of our code
reflects the logical structure of what we are doing. The shortcut for inserting a pipe
is <code>Ctrl + Shift + M</code> on Windows and <code>Cmd + Shift + M</code> on Mac.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="troubleshooting.html"><span class="header-section-number">5</span> Troubleshooting in R</a></div>
<div class="next"><a href="nums-chrs.html"><span class="header-section-number">7</span> Numbers, Characters, and Factors in R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#filter-select-mutate"><span class="header-section-number">6</span> Data Manipulation with R, Part 1</a></li>
<li><a class="nav-link" href="#objectives-3"><span class="header-section-number">6.1</span> Objectives</a></li>
<li><a class="nav-link" href="#additional-reading-3"><span class="header-section-number">6.2</span> Additional reading</a></li>
<li><a class="nav-link" href="#murray-sanchez-et-al.-data"><span class="header-section-number">6.3</span> Murray, Sanchez et al. data</a></li>
<li>
<a class="nav-link" href="#filtering-rows-creating-and-selecting-columns"><span class="header-section-number">6.4</span> Filtering rows; creating and selecting columns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#selecting-columns-with-select"><span class="header-section-number">6.4.1</span> Selecting columns with select()</a></li>
<li><a class="nav-link" href="#subsetting-data-with-filter"><span class="header-section-number">6.4.2</span> Subsetting data with filter()</a></li>
<li><a class="nav-link" href="#making-new-columns-with-mutate"><span class="header-section-number">6.4.3</span> Making new columns with mutate()</a></li>
<li><a class="nav-link" href="#sorting-data-tables"><span class="header-section-number">6.4.4</span> Sorting data tables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#pipes"><span class="header-section-number">6.5</span> Pipes</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Management and Reproducible Science</strong>" was written by Claire S Teitelbaum. It was last built on 2025-09-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
